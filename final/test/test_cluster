from sklearn.cluster import DBSCAN
import numpy as np
import pandas as pd

# Supón que ya tienes un DataFrame llamado `df` con columnas: ID, x, y
data = [[2.479906469321582, 7.723994950117143, 5], [2.480712907599372, 7.715657795482102, 5], [2.4829021806658504, 7.714744407134072, 5], [2.4873819611914114, 7.721173338201583, 5], [2.486374450057709, 7.729649875141561, 5], [2.4540625166909695, 7.757609109156297, 5], [2.3617466822225612, 7.786216877802577, 5], [2.2607700300462334, 7.822192599383963, 5], [2.1595465669987677, 7.862038140187536, 5], [2.1059643855641075, 7.871217462399923, 5], [2.0176678026920136, 7.895812558083124, 5], [1.9368582548571833, 7.916653294856113, 5], [1.8288209840137057, 7.931269520488506, 5], [1.7729619163846633, 7.944119224093684, 5], [1.7249000126594114, 7.953841313155967, 5], [1.6912940320494612, 7.971749383363563, 5], [1.6631457725202292, 7.989582775095375, 5], [1.6321657258857543, 7.981480187291094, 5], [1.6015893479087042, 7.99795665798292, 5], [1.576989303091765, 7.990885210893819, 5], [1.5604377222547532, 7.990705955262971, 5], [1.5375404002532957, 8.007017751801538, 5], [1.5196332595992457, 8.025993249876715, 5], [1.5037866977687753, 8.032357085971373, 5], [1.4948964374404397, 8.046150697302677, 5], [1.494602790330879, 8.046967875170381, 5], [1.4939728649761654, 8.044362402361434, 5], [1.49206421747505, 8.065016458347161, 5], [1.4889194535463475, 8.075362589071066, 5], [1.487986677881351, 8.084425877199347, 5], [1.489886827160059, 8.095134637887034, 5], [1.4906907020147664, 8.09530169372038, 5], [1.4910623784700243, 8.114546315004512, 5], [1.492540087609211, 8.119053469542186, 5], [1.491014437153436, 8.11678301146459, 5], [1.489964520629857, 8.129844825206963, 5], [1.488890287282521, 8.132837295240074, 5], [1.4939125758257357, 8.142393188119001, 5], [1.5046893795692173, 8.150605715372869, 5], [1.5177253344051225, 8.161831964104064, 5], [1.5337386619968871, 8.164574958228217, 5], [1.55109128624732, 8.169087024581938, 5], [1.570925427022142, 8.173395247458048, 5], [1.5935662893302736, 8.180390575270348, 5], [1.6157101627058643, 8.192608615802959, 5], [1.63630732716447, 8.190747834980632, 5], [1.6570674460200199, 8.198184196180145, 5], [1.6788509244483616, 8.204749833907359, 5], [1.6935681837233991, 8.211304954500719, 5], [1.7028682183572483, 8.215762752490411, 5], [1.710221787776228, 8.227357182804644, 5], [1.715149843130385, 8.230278641541442, 5], [1.7210354207695278, 8.236528296533704, 5], [1.7310575635221037, 8.246904501234997, 5], [1.7433442236392322, 8.251688546858784, 5], [1.7569090954476585, 8.257356119079681, 5], [1.771330184171524, 8.264281090534856, 5], [1.7865365687833648, 8.266558644498984, 5], [1.7949131011384218, 8.273937258315641, 5], [1.7964819110138794, 8.283770857434178, 5], [1.796413599868571, 8.28669675232337, 5], [1.7970805893034874, 8.295903088252864, 5], [1.7962231290404458, 8.301533014445656, 5], [1.795261888895863, 8.308755847749502, 5], [1.7957158126947212, 8.31834124474389, 5], [1.7954390953671713, 8.326003774240968, 5], [1.7992777278327456, 8.331441915495642, 5], [1.805937363800306, 8.337566086251366, 5], [1.8122236664505125, 8.33934843728266, 5], [1.8216772460259874, 8.352296902660553, 5], [1.8376109327019, 8.352008333097793, 5], [1.8561279240216833, 8.356255667498624, 5], [1.9010585241692226, 8.350310522443603, 5], [1.9284618311125805, 8.350763403434199, 5], [1.9624423711503707, 8.347059456134588, 5], [1.9973776758025774, 8.34086495027502, 5], [2.024136961231733, 8.336796055863994, 5], [2.050994762299208, 8.333009130341006, 5], [2.0846786621475544, 8.324203698952903, 5], [2.1173366454543965, 8.316435460504552, 5], [2.149484458104272, 8.309882098959816, 5], [3.595292038663267, 10.444887537436765, 73], [3.73576945963228, 10.348394124284551, 73], [3.862378563675944, 10.250741229003086, 73], [3.9708907010206524, 10.153544459135267, 73], [4.044950295914077, 10.066266088269575, 73], [4.0570279694714, 10.005800335703142, 73], [4.0479830703671995, 9.973406526867803, 73], [4.045515596491086, 9.969501218081449, 73], [4.0453190855768675, 9.969195575497736, 73], [4.054276133832786, 9.975786462085996, 73], [4.051821141930299, 9.97274306134959, 73], [4.06035418843729, 9.968948869818462, 73], [4.11659148930962, 9.930153583421566, 73], [4.228796272619717, 9.813578994241222, 73], [4.3640509366328875, 9.653315363382461, 73], [4.4766221282577, 9.490360141976659, 73], [4.5739266418730296, 9.326455055730817, 73], [4.658512697353354, 9.176944113531956, 73], [4.7176561394324565, 9.031265070818389, 73], [4.780416646882614, 8.897427479804383, 73], [4.810226256569387, 8.763547784170918, 73], [4.8601254479337035, 8.644456915699084, 73], [4.879547602321608, 8.52818400641046, 73], [4.892907601406515, 8.431227991033358, 73], [4.8998806224475455, 8.359287179209336, 73], [4.894483408303458, 8.32168831748758, 73], [4.901693141912693, 8.29905646615083, 73], [4.915373722851201, 8.288823380156913, 73], [4.9117073952103745, 8.28110691209699, 73], [4.922582124816121, 8.275772966906542, 73], [4.929020715291074, 8.272000990511987, 73], [4.932537737392213, 8.269288096598013, 73], [4.946539505822139, 8.267524261305834, 73], [4.9568036792509425, 8.265747905096784, 73], [4.961226319735867, 8.263653726716733, 73], [4.965112566570949, 8.262307717005829, 73], [4.978386859160875, 8.260957704411041, 73], [4.981311484455133, 8.261006797341977, 73], [4.989713437788241, 8.261450333788671, 73], [4.999633809630569, 8.262100376582108, 73], [5.004623704006862, 8.26300174823792, 73], [5.013101649180696, 8.263327709816735, 73], [5.020190101475548, 8.264995888156944, 73], [5.026394822363217, 8.279685871347523, 73], [5.032171999774306, 8.32909021029302, 73], [5.03317769005687, 8.382664133106294, 73], [5.039401171961251, 8.436007600863904, 73], [5.039138700082021, 8.485146868332881, 73], [5.043788366159462, 8.511777351915308, 73], [5.036828881959756, 8.579188952207824, 73], [5.035645022749526, 8.627572089676901, 73], [5.033209150620252, 8.676701708691375, 73], [5.030528265569049, 8.72218862340195, 73], [5.021929369252691, 8.759342511342181, 73], [5.013583104895468, 8.798620796207727, 73], [5.007294803980781, 8.829800458822739, 73], [5.001386060968091, 8.854377756132939, 73], [4.997390148637472, 8.88682529316039, 73], [4.987096842901666, 8.913057752353303, 73], [4.977899510801153, 8.943286461426878, 73], [4.974322183378907, 8.96922327631111, 73], [4.965738136534748, 8.98857533989578, 73], [4.956614965115289, 9.009723496889423, 73], [7.209548782362399, 10.264413360269899, 10], [7.05116340297217, 10.50842604897107, 10], [6.882754095842596, 10.73398353947662, 10], [6.698559630181289, 10.918301341024652, 10], [6.5234756957079885, 11.075555970399593, 10], [6.347830549333764, 11.181720418261719, 10], [6.168336637120652, 11.251308997628923, 10], [6.032619434737704, 11.305340893108855, 10], [5.943438132411578, 11.336851976344327, 10], [5.921761406629087, 11.353506568425173, 10], [5.9015444284536525, 11.374121480964419, 10], [5.873796112595541, 11.390493505528875, 10], [5.8500716860054425, 11.409773917392942, 10], [5.839598830464855, 11.424333436026103, 10], [5.815793999574196, 11.440175115594368, 10], [5.783694890714093, 11.45625439896287, 10], [5.77114705702807, 11.482839076444648, 10], [5.7476230015889875, 11.483112364768953, 10], [5.731051797442952, 11.506041614543388, 10], [5.705798909755487, 11.510461012904498, 10], [5.672487825969352, 11.526391844704863, 10], [5.6418193279948055, 11.54128224852219, 10], [5.559408124470787, 11.574704640538027, 10], [5.515204669297624, 11.587157481474762, 10], [5.481142966178584, 11.608470724751493, 10], [5.450559263438803, 11.615105733951866, 10], [5.433802741048757, 11.63064519617237, 10], [5.4503327779557775, 11.63819641345091, 10], [5.460143096687309, 11.639943185552074, 10], [5.487014059692942, 11.639706943933374, 10], [5.504464226932536, 11.642448656042912, 10], [5.5145083720801065, 11.640913963469824, 10], [5.52095601584644, 11.65085370429392, 10], [5.530906391691336, 11.660174250120134, 10], [5.530037903898283, 11.663775503592642, 10], [5.5251398147945014, 11.668707567138792, 10], [5.514527080666946, 11.685946018367304, 10], [5.49770672834184, 11.700422837147634, 10], [5.479146699180161, 11.707156038975606, 10], [5.463490834084358, 11.721141458785683, 10], [5.447355593201107, 11.73402713273085, 10], [5.43242540368789, 11.744298355626192, 10], [5.420897609647814, 11.758436197264736, 10], [5.40902705065619, 11.766666071468336, 10], [5.396339286844811, 11.777890178041726, 10], [5.3843555401416054, 11.79139168865305, 10], [5.3757181734292745, 11.7955922092897, 10], [5.370529319913391, 11.805801059848605, 10], [5.368163485848368, 11.814013217406842, 10], [5.3706166123344845, 11.822450008314302, 10], [5.377322421948769, 11.826190157732297, 10], [5.3878709690188895, 11.831530715661035, 10], [5.419684788643789, 11.831762848413579, 10], [5.4607297101156, 11.827017112999577, 10], [5.502971493186817, 11.821376484718797, 10], [5.5437677805579275, 11.812920180125118, 10], [5.583126384882557, 11.806060858775627, 10], [5.621045890141354, 11.796129253036513, 10], [5.66637231555262, 11.777886748900496, 10], [5.724731455000871, 11.752802330608995, 10], [5.7792966930796466, 11.725017882243929, 10], [6.8023507771776694, 13.523910989940612, 10], [6.961781424323858, 13.422915092839357, 10], [7.1092010557388665, 13.315680823586975, 10], [7.251696914803362, 13.199480902049508, 10], [7.377387239719133, 13.079342781544455, 10], [7.466498016621093, 12.947944648975758, 10], [7.535279433218646, 12.81449678871846, 10], [7.615697488115535, 12.708798312587028, 10], [7.681375038969772, 12.609658271100665, 10], [7.728219362293153, 12.517541332309273, 10], [7.769003528130012, 12.440720600381153, 10], [7.8077640364349445, 12.373835830030607, 10], [7.836595570909312, 12.31131025784332, 10], [7.850901693206884, 12.275169536340055, 10], [7.865605847773015, 12.26032654837452, 10], [7.852456431491715, 12.313607263408992, 10], [7.839790750876894, 12.375679270833341, 10], [7.826025134310472, 12.430379845509204, 10], [7.8162705843417655, 12.4629803759784, 10], [7.815833894769465, 12.475257669901255, 10], [7.8146900482084405, 12.473911401694956, 10], [7.82403543639276, 12.467430634539273, 10], [7.838274082948374, 12.46589015414998, 10], [7.858425838151274, 12.450742369586187, 10], [7.869071883553482, 12.437124637468774, 10], [7.8792898299967735, 12.423816496815233, 10], [7.897524762784257, 12.413925158018289, 10], [7.91106922941425, 12.402803118549997, 10], [7.918823776035371, 12.38877982519696, 10], [7.934305425195609, 12.372693017701563, 10], [7.955433760567597, 12.360234481400637, 10], [7.965182294068863, 12.346098435735637, 10], [7.975608985938074, 12.33688246136294, 10], [7.98652745153379, 12.331690891775091, 10], [7.994409595029701, 12.330058915657037, 10], [8.0036512468475, 12.325582216473855, 10], [8.009631044077038, 12.327023756896816, 10], [8.016544150416175, 12.332344499263503, 10], [8.016380794400035, 12.35161016652625, 10], [8.00583170275109, 12.387253535497644, 10], [7.997070246292521, 12.42496531179365, 10], [7.984738596077691, 12.460203771155088, 10], [7.971988655922821, 12.494668046065648, 10], [7.957584883265267, 12.527228441950449, 10], [4.925942083957852, 8.132261115546424, 10], [5.398066685126783, 8.515605969967147, 10], [5.679160584823112, 8.752571118426907, 10], [5.8706206948434385, 9.003261577677637, 10], [6.076364342370482, 9.184421878560276, 10], [6.159963727930364, 9.339166663499407, 10], [6.18473635851784, 9.353164548430518, 10], [6.183781367048976, 9.348212834036978, 10], [6.197877758958493, 9.341587414891036, 10], [6.184929695768615, 9.345619883262778, 10], [6.209869132301524, 9.33393800012496, 10], [6.215454374568026, 9.354876779534507, 10], [6.249831295737939, 9.36860859378975, 10], [6.263348212066015, 9.398347094707145, 10], [6.31860844634779, 9.427650437260237, 10], [6.397866936612582, 9.467172955649819, 10], [6.426829761879137, 9.591275235997491, 10], [6.526890710955779, 9.689294234226603, 10], [6.562808706452926, 9.814248459565675, 10], [6.631389832722498, 9.912122487710379, 10], [6.65046241854445, 9.981110102968762, 10], [6.70327605937616, 9.973710342553899, 10], [6.740239251435899, 10.020709107443455, 10], [6.771716667271556, 10.0571260730319, 10], [6.760195982151794, 10.12714043346033, 10], [6.807264546808102, 10.188354351081433, 10], [6.856148531495175, 10.262978748457863, 10], [6.913973503184071, 10.347296436829616, 10], [6.9783637501709865, 10.434250472363475, 10], [6.9861334891729046, 10.531350216656792, 10], [7.008127648015279, 10.596327190372826, 10], [7.060160485097132, 10.656242251870134, 10], [7.096096232737855, 10.712955522758959, 10], [7.070352891790448, 10.755868163509387, 10], [7.079850222097285, 10.769934334064882, 10], [7.163240913352974, 10.771221206082272, 10], [7.152807800223442, 10.808450182741735, 10], [7.150949695276914, 10.829226882596869, 10], [7.18841503714286, 10.84928648641494, 10], [7.227238238866559, 10.864634241242566, 10], [7.235451162805907, 10.900072668035861, 10], [7.234389115382642, 10.951851572838432, 10], [7.266106067521813, 10.981796196179914, 10], [7.273150581325066, 11.097996094490766, 10], [7.30648220973366, 11.13530892916753, 10], [7.3123638834129165, 11.25993611885783, 10], [7.366039133261782, 11.343644863987716, 10], [7.580450307692813, 11.412716320399975, 10], [7.4882890531150865, 11.487427669706475, 10], [7.435533013233711, 11.553367024076046, 10], [7.6118295093554185, 11.597076999635801, 10], [7.3845804909507935, 11.634863275102589, 10], [7.645081465562416, 11.647432852845805, 10], [7.653832388375274, 11.684444411728258, 10], [7.651650200696139, 11.693411115048118, 10], [7.663290695254142, 11.70689101620796, 10], [7.6714954898258, 11.639130974729898, 10], [7.6722755645713665, 11.224744436696492, 10], [7.652904271493577, 11.044115098252357, 10], [7.558868334640159, 10.556848254310202, 10], [7.500699046842735, 10.396956023436372, 10], [7.376797232414645, 10.10304072087173, 10], [7.224860767898445, 9.846584413314202, 10], [7.065283820234695, 9.622301710952787, 10], [6.841445512496943, 9.365732530733903, 10], [6.774918407088068, 9.329005623204694, 10], [6.776126285815804, 9.331024750148622, 10], [6.775927153556074, 9.334242346343238, 10], [6.777530295158769, 9.334415410625004, 10], [6.781527033382892, 9.333024673981678, 10], [6.783855991552021, 9.333298714057781, 10], [6.79234803240379, 9.324746624910299, 10], [6.908402099421302, 9.422606371199588, 10], [7.15527221825011, 9.66527023391107, 10], [7.371647255286763, 9.945120508046534, 10], [7.554652432229407, 10.230391482364995, 10], [7.715084320113159, 10.550553058058368, 10], [7.818623654025108, 10.864932824207402, 10], [7.885611523485236, 11.173235802309119, 10], [7.905892744531492, 11.473996961408586, 10], [7.8615102161894015, 11.762828231311177, 10], [7.815598695881212, 12.023956126570157, 10], [7.800311535313226, 12.150550705274828, 10], [7.723843921704738, 12.463090822449226, 10], [7.663166859149399, 12.642732759144529, 10], [7.590735429132202, 12.792568233216572, 10], [7.536370976658322, 12.927801038448044, 10], [7.47543176845288, 13.037701001143956, 10], [7.427727141678809, 13.113419780980657, 10], [7.3867966287634665, 13.160081529517003, 10], [7.355409297394965, 13.185888357815841, 10], [7.373927498277711, 13.140720443313198, 10], [7.4197025438506214, 13.0747440118549, 10], [7.469278317040145, 13.018169097840204, 10], [7.510398402664967, 12.965899819581052, 10], [7.540538288413634, 12.929200388230667, 10], [7.560964416646821, 12.903316075565959, 10], [7.58455405383898, 12.887743297349655, 10], [7.594801736769669, 12.879123745789064, 10], [7.595327178876084, 12.878160877591082, 10], [7.604228106949689, 12.887281963911757, 10], [7.602396516676852, 12.900335054694272, 10], [7.60018632426247, 12.916289928894628, 10], [7.596252569116382, 12.939987950395802, 10], [7.616283565620591, 12.913266867186305, 10], [7.707859897709999, 12.784487291393964, 10], [7.779922809859385, 12.636308729432496, 10], [7.848411434553652, 12.490424472080255, 10], [7.903521954831733, 12.350270062145459, 10], [7.926505671035599, 12.281856863755769, 10], [7.963277226879994, 12.15999730206741, 10], [7.99291422350878, 11.992509425509777, 10], [8.002239628489498, 11.885842424466267, 10], [8.007149132590238, 11.792632617446158, 10], [8.01295447960254, 11.714639852915655, 10], [8.01403055045073, 11.6553327630028, 10], [8.018221907517976, 11.625718353422416, 10], [8.004593003173222, 11.55975613935889, 10], [8.002641948028579, 11.527801600360755, 10], [8.007632952534578, 11.51105267122694, 10], [8.014461822294717, 11.496661990315777, 10], [8.01665711998043, 11.482696916753326, 10], [8.018608826086867, 11.467572567796752, 10], [8.026363669707198, 11.449997391049452, 10], [8.027247514637526, 11.435029540356682, 10], [8.033105500425973, 11.41822883857468, 10], [8.034311023089776, 11.39907473707998, 10], [8.039581314580513, 11.386419867261061, 10], [8.034772364639268, 11.33876184338354, 10], [8.031769678051011, 11.292561624990732, 10], [8.025241534469416, 11.251456999895153, 10], [8.023437764474435, 11.226548138297499, 10], [8.020289860324116, 11.204837753692232, 10], [8.020272064796695, 11.188700794356542, 10], [8.016289629550535, 11.164893127761719, 10], [8.013932912841023, 11.143531171736162, 10], [7.98526878161554, 11.08200912511297, 10], [7.955580171601417, 11.02613577830452, 10], [9.140054504129287, 2.8488477433287978, 15]]
df = pd.DataFrame(data, columns=["x", "y", "ID"])

eps_distance = 1.5  # Distancia máxima entre puntos para considerarse en el mismo grupo
min_samples = 1     # Consideramos hasta detecciones individuales como un grupo

id_especifico = 73
puntos = df[df['ID'] == id_especifico][['x', 'y']].to_numpy()

# Verifica que hay puntos
if len(puntos) == 0:
    print(f"No hay puntos para ID {id_especifico}")
else:
    clustering = DBSCAN(eps=eps_distance, min_samples=min_samples).fit(puntos)
    etiquetas = clustering.labels_
    num_clusters = len(set(etiquetas)) - (1 if -1 in etiquetas else 0)
    print(f"ID {id_especifico} tiene {num_clusters} grupo(s)")
